"use strict";angular.module("OxApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","notificationModule","ui.bootstrap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/session/login.html",controller:"LoginCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/pipeline/dashboard",{templateUrl:"views/pipeline/dashboard.html",controller:"DashboardCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("OxApp").controller("MainCtrl",["$scope",function(){}]),angular.module("OxApp").controller("AboutCtrl",["$scope",function(){}]),angular.module("OxApp").service("ApiUtils",["$http",function(a){a.defaults.headers.common.Authorization="Bearer accessToken";var b="http://172.17.201.94:9091/Ox-Server/me";this.getServerURL=function(){return b},this.buildQueryParam=function(a){var b,c;if(!(a&&a instanceof Object))throw"ApiUtils.buildQueryParam: expected params as Json";c="?";for(b in a)c+="&"+b+"="+a[b];return"?"==c?"":c=c.replace("?&","?")},this.get=function(b,c,d){a.get(b).then(function(a){console.log(""),c(a)},function(a){console.log(""),d(a)})},this.post=function(b,c,d,e){a.post(b,c).then(function(a){console.log(""),d(a)},function(a){console.log(""),e(a)})},this.put=function(){},this.delete=function(){}}]),angular.module("OxApp").controller("LoginCtrl",["$scope","$location",function(a,b){a.logged=function(){b.path("/pipeline/dashboard")}}]),angular.module("OxApp").controller("DashboardCtrl",["$scope","$modal","Project","Stage","NotificationAPI",function(a,b,c,d,e){a.projects=[],a.open=function(){b.open({templateUrl:"myModalContent.html",controller:h})};var f=function(b){a.projects=b.data},g=function(a){console.log("Error: "+a)},h=["$scope","$modalInstance",function(a,b){a.project={};var f=function(a){var b=a.split("/");return b[b.length-1]},h=function(){e.showNotification("Se ha creado el proyecto con exito."),b.close()},i=function(b){var c={type:"commit-stage",url:a.project.url,branch:a.project.branch},e=f(b.headers("Location"));d.setStage(e,c,h,g)};a.createProject=function(d){a.project=d;var e={name:d.name,description:d.description};c.saveProject(e,i,g),b.close()},a.cancel=function(){b.dismiss("cancel")}}];c.getProjects(f,g)}]),angular.module("OxApp").service("ApiProject",["$http","$location","ApiUtils",function(a,b,c){var d=c.getServerURL();this.getProjects=function(b,c){a.get(d+"/projects").then(function(a){console.log(""),b(a)},function(a){console.log(""),c(a)})},this.saveProject=function(b,c,e){a.post(d+"/projects",b).then(function(a){console.log(""),c(a)},function(a){console.log(""),e(a)})}}]),angular.module("OxApp").service("Project",["ApiProject",function(a){var b=function(a){console.log("Error:"+a)};this.getProjects=function(c){var d=function(a){c(a)};a.getProjects(d,b)},this.saveProject=function(c,d){var e=function(a){d(a)};a.saveProject(c,e,b)}}]),angular.module("OxApp").service("Stage",["ApiStage",function(a){var b=function(a){console.log("Error:"+a)};this.setStage=function(c,d,e){var f=function(a){e(a)};a.setStage(c,d,f,b)}}]),angular.module("OxApp").service("ApiStage",["$http","$location","ApiUtils",function(a,b,c){var d=c.getServerURL();this.setStage=function(b,c,e,f){a.post(d+"/projects/"+b+"/stages",c).then(function(a){console.log(""),e(a)},function(a){console.log(""),f(a)})}}]),function(a,b){b.module("notificationModule",[]).controller("NotificationController",["$scope","NotificationAPI",function(a,b){a.api=b}]).factory("NotificationAPI",function(){return{status:!1,message:"",showNotification:function(a){this.status=!0,this.message=a},clear:function(){this.status=!1}}}).directive("notification",["$timeout","$animate",function(a,b){return{restrict:"E",replace:!0,controller:"NotificationController",template:'<div class="alert alert-success" role="alert" ng-show="api.status"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>{{api.message}}</div>',link:function(c,d,e){c.$watch(e.ngShow,function(e){e&&a(function(){c.api.status=!1,b.removeClass(d,"ng-hide")},5e3)})}}}])}(window,window.angular);